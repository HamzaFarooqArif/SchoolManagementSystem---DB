@model IEnumerable<WebApplication1.Course>

@{
    ViewBag.Title = "Create";
}
<h2>Create</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <div class="form-horizontal">
        <select id="Batch" class="form-control" style="float: left;">
            <option></option>
        </select>
        @Html.ActionLink("Create New", "Create", "Batch")
        <select id="Semester" class="form-control">
            <option></option>
        </select>
        <div class="form-group">
            <div class="col-md-10">
                <input id="btnSubmit" type="button" value="Submit" class="btn btn-default" />
                @*<input type="submit" value="Load Products" name="btn" class="btn btn-default" />*@
            </div>
        </div>
    </div>

    <table class="table" id="courseTable">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Name)
            </th>
            <th></th>
        </tr>

        @*@foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Session)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.ID }) |
                    @Html.ActionLink("Details", "Details", new { id = item.ID }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.ID })
                </td>
            </tr>
        }*@

    </table>
    <p id="para"></p>
}
@section Scripts{
    <script type="text/javascript">
        $(document).ready(function (e) {
            var d = {};
            d.url = '@Url.Action("LoadBatches", "Semester")';
            d.type = "POST";
            d.dataType = "json";
            d.contentType = "application/json";
            d.success = function (r) {
                $("#Batch").empty();
                $("#Batch").prepend("option value='' selected='selected'></option>");
                for (var i = 0; i < r.length; i++) {
                    $("#Batch").append('<option value="' + r[i].ID + '">' + r[i].Name + '</option>');
                }
            };
            $.ajax(d);
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#Batch").change(function () {
                debugger;
                event.preventDefault();
                //var selectedValue = $("#Batch").select();
                var $url = '/Semester/LoadSemester';
                //alert($url);

                $.ajax({
                    url: $url,
                    type: 'POST',
                    datatype: "json",
                    data: jQuery.param({
                        item: $("#Batch option:selected").val(),
                    }),
                   // data: "Item=" + $("#Batch option:selected").val(),
                    success: function (r) {
                        $("#Semester").empty();
                        $("#Semester").prepend("option value='' selected='selected'></option>");
                        for (var i = 0; i < r.length; i++) {
                            $("#Semester").append('<option value="' + r[i].ID + '">' + r[i].Name + '</option>');
                        }
                    }
                });
            });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#btnSubmit").click(function () {
                debugger;
                event.preventDefault();
                //var selectedValue = $("#Batch").select();
                var $url = '/Semester/LoadSemesterCourses';
                //alert($url);

                $.ajax({
                    url: $url,
                    type: 'POST',
                    datatype: "json",
                    data: jQuery.param({
                        semesterID: $("#Semester option:selected").val()
                    }),
                    success: function (r) {
                        $("#courseTable tr").remove();
                        for (var i = 0; i < r.length; i++)
                        {
                            $("#courseTable").append(
                                "<tr>" +
                                "<td>"+r[i].Name+"</td>" +
                                "<td><a href=/Semester/Edit/"+r[i].ID+">Edit</a></td>" +
                                "</tr>"
                                );                           
                        }
                    }
                });
            });
        });
</script>

}

@*@foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Session)
            </td>
            <td>
                @Html.ActionLink("Edit", "Edit", new { id = item.ID }) |
                @Html.ActionLink("Details", "Details", new { id = item.ID }) |
                @Html.ActionLink("Delete", "Delete", new { id = item.ID })
            </td>
        </tr>
    }*@